<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Absensi & Poin</title>
<style>
:root{
  --bg: #f7f8fa;
  --card: rgba(255,255,255,0.6);
  --glass-border: rgba(255,255,255,0.6);
  --text: #111;
  --muted: #666;
  --accent: #0a84ff;
  --danger: #e55050;
  --glass-blur: 10px;
  --radius: 14px;
}
body.dark{
  --bg: #0b0b0d;
  --card: rgba(20,20,22,0.45);
  --glass-border: rgba(255,255,255,0.06);
  --text: #e8eef8;
  --muted: #b3b6be;
  --accent: #60a5ff;
  --danger: #ff6b6b;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background: var(--bg);
  color: var(--text);
  padding: 20px;
}
.app{
  max-width: 900px;
  margin: auto;
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}
h1{font-size:20px}
.btn{
  padding:8px 14px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  background:var(--accent);
  color:white;
}
.btn-outline{
  background:transparent;
  border:1px solid var(--accent);
  color:var(--accent);
}
.toggle{
  margin-left:10px;
}
.panel{
  background: var(--card);
  backdrop-filter: blur(var(--glass-blur));
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 16px;
}
form{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-bottom:10px;
}
form input{
  padding:8px;
  border:1px solid #ccc;
  border-radius:8px;
  flex:1;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border-bottom:1px solid rgba(0,0,0,0.1);
  padding:8px;
}
th{
  background:rgba(255,255,255,0.3);
}
td[contenteditable="true"]{
  background:rgba(255,255,255,0.2);
}
.action-btn{
  background:var(--danger);
  color:white;
  border:none;
  border-radius:6px;
  padding:4px 8px;
  cursor:pointer;
}
</style>
</head>
<body>
<div class="app">
<header>
  <h1>Absensi & Poin</h1>
  <div>
    <button class="btn-outline" id="toggleTheme">ðŸŒ™ Mode</button>
    <button class="btn" id="downloadBtn">Download Excel</button>
  </div>
</header>
<div class="panel">
  <form id="dataForm">
    <input type="text" id="nameInput" placeholder="Nama" required>
    <input type="number" id="pointInput" placeholder="Poin" required>
    <button type="submit" class="btn">Tambah</button>
  </form>
  <table id="dataTable">
    <thead>
      <tr>
        <th>Nama</th>
        <th>Poin</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>
</div>

<script>
const form = document.getElementById('dataForm');
const tableBody = document.querySelector('#dataTable tbody');
const downloadBtn = document.getElementById('downloadBtn');
const toggleTheme = document.getElementById('toggleTheme');
let data = [];

form.addEventListener('submit', e => {
  e.preventDefault();
  const name = document.getElementById('nameInput').value.trim();
  const point = document.getElementById('pointInput').value.trim();
  if(name && point !== ""){
    data.push({name, point});
    renderTable();
    form.reset();
  }
});

function renderTable(){
  tableBody.innerHTML = "";
  data.forEach((row, i) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td contenteditable="true" oninput="updateName(${i}, this.innerText)">${row.name}</td>
      <td contenteditable="true" oninput="updatePoint(${i}, this.innerText)">${row.point}</td>
      <td><button class="action-btn" onclick="deleteRow(${i})">Hapus</button></td>
    `;
    tableBody.appendChild(tr);
  });
}

function updateName(index, value){
  data[index].name = value.trim();
}
function updatePoint(index, value){
  data[index].point = value.trim();
}
function deleteRow(index){
  data.splice(index,1);
  renderTable();
}

downloadBtn.addEventListener('click', () => {
  if(data.length === 0){
    alert("Tidak ada data untuk di-download");
    return;
  }
  let csv = "Nama,Poin\n";
  data.forEach(row => {
    csv += `${row.name},${row.point}\n`;
  });
  const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "absensi_poin.csv";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
});

toggleTheme.addEventListener('click', () => {
  document.body.classList.toggle('dark');
});
</script>
</body>
</html>
